let use_token_id_as_seed=!1,token_id=123,seedi=new Date().getTime(),svgns="http://www.w3.org/2000/svg",main_svg=document.querySelector("#main-svg"),clustering_counter=0;const holders_distribution_upper_threshold=.8,holders_distribution_lower_threshold=.2;let seed_token=use_token_id_as_seed?token_id:seedi;const ALCHEMY_URL="https://eth-sepolia.g.alchemy.com/v2/s6IWaskbmCAb1QqDzvOVQci2DYFcDudq";function hexToString(e){let t="";for(let r=0;r<e.length;r+=2){let a=String.fromCharCode(parseInt(e.substr(r,2),16));t+=a}return t}function hexToArray(e){let t=e.slice(2),r=[];for(let a=0;a<t.length;a+=64){let i=t.slice(a,a+64),n=parseInt(i,16);r.push(n)}return r}let number_of_colors_to_use=14,colors_chance_distribution=[.7,.1,.1,.1,.1,.1,.1,.1,.1,.1,.1,.1,.1,.1],colors={gold1:{regular:[["#ff1249;#6b6cff;#c80085;#ffe112;#ff1249","#6b6cff;#ff1249;#ffe112;#c80085;#6b6cff"]],light:[["#ff4637;#83a9ff;#e91278;#fff149;#ff4637","#9ab0fe;#ff5252;#fffb57;#f23662;#9ab0fe"]],dark:[["#b2004e;#573fcd;#990086;#ec7d1a;#b2004e","#442dbe;#c2045c;#d26b0a;#a80094;#442dbe"]]},gold2:{regular:[["#f72585;#4cc9f0;#f72585","#4cc9f0;#f72585;#4cc9f0"]],light:[["#ff6494;#98e8ed;#ff6494","#9affff;#ff6277;#9affff"]],dark:[["#c4107c;#1d5fb6;#c4107c","#2d5ec8;#b40d85;#2d5ec8"]]},monochrome1:{regular:[["#010101;#fafafa;#010101","#fafafa;#010101;#fafafa"]],dark:[["#050505;#7b7b7b;#050505","#7b7b7b;#050505;#7b7b7b"]],light:[["#454545;#fafafa;#454545","#fafafa;#454545;#fafafa"]]},monochrome2:{regular:[["#080808;#828282;#d2d2d2;#202020;#7d7d7d;#080808","#efefef;#353535;#161616;#b2b2b2;#383838;#f5f5f5"]],light:[["#f5f5f5;#4e4e4e;#373737;#dedede;#787878;#f5f5f5","#404040;#949494;#eeeeee;#444444;#939393;#404040"]],dark:[["#080808;#4f4f4f;#818181;#1b1b1b;#515151;#080808","#929292;#242424;#0f0f0f;#898989;#323232;#818181"]]},blue_pink:{regular:[["#a7c3ff;#ff0066;#ffa9bd;#ff0066;#a7c3ff","#ff9ea1;#0000ff;#68b6ff;#0000ff;#ff9ea1"]]},blue_pink_light:{regular:[["#c0d5ff;#0000ff;#ffe1db;#150070;#c0d5ff","#fee3dc;#ff66ff;#c9e9ff;#ff66ff;#fee3dc"]]},blue_red_dark:{regular:[["#0000ff;#000080;#ff2a5b;#000080;#0000ff","#dd3a3f;#03000f;#0062be;#03000f;#dd3a3f"]]},black_pink:{regular:[["#ffff99;#ff668a;#ffff99","#ff668a;#ffff99;#ff668a"]]},blue_pink_yellow_light:{regular:[["#ff66ff;#ccffff;#ffbb33;#ffff66;#ff66ff;","#ffbb33;#ff66ff;#ffff66;#ccffff;#ffbb33"]]},black_orange:{regular:[["#3366ff;#ff5500;#3366ff","#ff5500;#3366ff;#ff5500"]]},blue_orange_lilac:{regular:[["#3333ff;#ff99ff;#b30059;#ff9933;#3333ff","#ffff66;#b30059;#000099;#5c00e6;#ffff66"]]},pink_yellow:{regular:[["#ffe112;#ff668a;#ffe112","#ff668a;#ffe112;#ff668a"]]}},special_color_names=["monochrome1","monochrome2"];for(let color_name of(color_combinations=[],colors_chance_distribution.reverse(),shuffle(Object.keys(colors).filter(e=>-1==special_color_names.indexOf(e))).slice(0,number_of_colors_to_use)))color_combinations.push({chance:colors_chance_distribution.pop(),colors:colors[color_name]});let background_color_durations=[60,120],randomize_cluster_shapes_scale=[],randomize_cluster_shapes=!0,center_clusters=!0,clustering_modes={upwards:[1,2,7],downwards:[4,0,8],vertical:[6,2,10],horizontal:[9,5,11]},clustering_mode=[1,1],cluster_shapes_update_time=5,cluster_shapes_fade_time=5,cluster_shapes_fade_trigger_randomize=5,plate_shapes_update_time=5,plate_shapes_fade_time=5,plate_shapes_fade_trigger_randomize=5,gradient_speed_change_on_approvals=.5,number_of_cluster_shapes_to_add_or_remove_on_transfer_increase=5,fade_time_when_new_cluster_shape_is_added_or_removed=5e3,clustering_density_update_on_distribution_change=.1,fade_in_speed_when_new_layers_are_added=5e3,min_number_of_plate_layers=1,max_number_of_plate_layers=20,holder_distribution_upper_threshold_percent=55,holder_distribution_lower_threshold_percent=44,background_color_combinations_list=color_combinations,milestones={token_hodld:[157788e5,315576e5,631152e5,157788e6,315576e6],transactions:[1e3,2e3,1e4,1e5,2e5,1e6]},send_frame_and_background_colors=["#e60036;#ff3385;#e60036","#ff3385;#e60036;#ff3385","#ff3385;#e60036;#ff3385","#e60036;#ff3385;#e60036"],sale_frame_and_background_colors=["#ffe112;#e67300;#ffe112","#e67300;#ffe112;#e67300","#e67300;#ffe112;#e67300","#ffe112;#e67300;#ffe112",],layers=[{id:"lp0",type:"plate",paths:paths["L - zigupdown"],color_duration:[20,50],coordinates:[[0,20],[0,30]],scale:[.5,1.8],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0]},{id:"lc0",type:"cluster",paths:paths["LS - right angles L"],color_duration:[20,50],coordinates:[[-30,30],[-10,10]],scale:[.05,.15],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0]},{id:"lp1",type:"plate",paths:paths["L - overhead"],color_duration:[20,80],coordinates:[[0,20],[0,30]],scale:[.5,1.8],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0]},{id:"lc1",type:"cluster",paths:paths["LS - cloud"],color_duration:[20,80],coordinates:[[-10,10],[-30,30]],scale:[.05,.15],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0]},{id:"lp2",type:"plate",paths:paths["L - body"],color_duration:[20,80],coordinates:[[0,20],[0,30]],scale:[.5,1.8],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0]},{id:"lc2",type:"cluster",paths:paths["LS - cut planes"],color_duration:[20,80],coordinates:[[-10,80],[-10,30]],scale:[.05,.15],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0]},{id:"lp3",type:"plate",paths:paths["L - cut shapes"],color_duration:[20,80],coordinates:[[0,20],[0,30]],scale:[.5,1.8],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0]},{id:"lc3",type:"cluster",paths:paths["LS - planets"],color_duration:[20,80],coordinates:[[-30,10],[-30,50]],scale:[.05,.15],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0]}],special_layers=[{id:"s_lp0",type:"plate",paths:paths["L - boom"],color_duration:[20,50],coordinates:[[20,80],[20,80]],scale:[.5,1.5],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lc0",type:"cluster",paths:paths["LS - waveform"],color_duration:[20,50],coordinates:[[-30,30],[-10,10]],scale:[.05,.1],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lp1",type:"plate",paths:paths["L - stars"],color_duration:[20,80],coordinates:[[20,80],[20,80]],scale:[.5,1.5],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lc1",type:"cluster",paths:paths["S - bird arrows"],color_duration:[20,80],coordinates:[[-10,10],[-30,30]],scale:[.05,.1],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lp2",type:"plate",paths:paths["L - lines 3"],color_duration:[20,80],coordinates:[[20,80],[20,80]],scale:[.5,1.5],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lc2",type:"cluster",paths:paths["LS - crack"],color_duration:[20,80],coordinates:[[-10,80],[-10,30]],scale:[.05,.1],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lp3",type:"plate",paths:paths["L - zigupdown"],color_duration:[20,80],coordinates:[[20,80],[20,80]],scale:[.5,1.5],number_of_visible_shapes:2,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[0,0],gradient_coordinates:[0,0,100,0],classes:["special"]},{id:"s_lc3",type:"cluster",paths:paths["LS - chevrons"],color_duration:[20,80],coordinates:[[-30,10],[-30,50]],scale:[.05,.03],number_of_visible_shapes:30,change_positions_chance:.5,color_combinations_list:color_combinations,clustering_density:[7,9],gradient_coordinates:[0,0,100,0],classes:["special"]}];for(let layer of layers)layer.classes=[];let original_number_of_plate_layers=layers.filter(e=>"plate"==e.type).length,use_token_id_seed_for_initial_layer_paths=!0,startup_timestamp=new Date().getTime();add_defs_svg(),add_background(),add_layers(),add_background_border();let piece_is_sent_frame_color_changed_timestamp=0,piece_is_sold_frame_color_changed_timestamp=0,stop_all_animations=!1;async function test_state_updates(e,t){if("send"==e){change_chance_of_position_change_for_period("cluster",1,2e4);let r=document.querySelector(".frame"),a=document.querySelector("#background"),i=r.cloneNode(!0),n=a.cloneNode(!0);i.setAttribute("fill","url(#gradient_bg_mirror_read_and_black)"),n.setAttribute("fill","url(#gradient_bg_read_and_black)");let o=document.querySelector("#gradient_bg_mirror"),l=document.querySelector("#gradient_bg"),s=o.cloneNode(!0),$=l.cloneNode(!0);s.setAttribute("id","gradient_bg_mirror_read_and_black"),$.setAttribute("id","gradient_bg_read_and_black");let c=Array.from(send_frame_and_background_colors);for(let d of s.querySelectorAll("stop")){let u=d.querySelector("animate");u.setAttribute("values",c.pop()),u.setAttribute("dur","20s")}for(let f of $.querySelectorAll("stop")){let p=f.querySelector("animate");p.setAttribute("values",c.pop()),p.setAttribute("dur","30s")}o.after(s),l.after($),i.setAttribute("opacity","0"),i.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),r.after(i),n.setAttribute("opacity","0"),n.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),a.after(n),await update_layers_order(1,5,20,!0),await new Promise(e=>setTimeout(e,1e3*randomf(2,6))),i.setAttribute("opacity","1");let g=i.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"});g.onfinish=function(){s.remove(),i.remove()},n.setAttribute("opacity","1"),(g=n.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"})).onfinish=function(){$.remove(),n.remove()}}if("sale"==e){change_chance_of_position_change_for_period("cluster",1,2e4);let _=document.querySelector(".frame"),m=_.cloneNode(!0);m.setAttribute("fill","url(#gradient_bg_mirror_read_and_black)");let h=document.querySelector("#gradient_bg_mirror"),y=h.cloneNode(!0);y.setAttribute("id","gradient_bg_mirror_read_and_black");let S=Array.from(sale_frame_and_background_colors);for(let v of y.querySelectorAll("stop")){let A=v.querySelector("animate");A.setAttribute("values",S.pop()),A.setAttribute("dur","20s")}h.after(y),m.setAttribute("opacity","0"),m.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),_.after(m);let w=document.querySelector("#background"),k=w.cloneNode(!0);k.setAttribute("fill","url(#gradient_bg_read_and_black)");let N=document.querySelector("#gradient_bg"),q=N.cloneNode(!0);for(let L of(q.setAttribute("id","gradient_bg_read_and_black"),q.querySelectorAll("stop"))){let C=L.querySelector("animate");C.setAttribute("values",S.pop()),C.setAttribute("dur","30s")}N.after(q),k.setAttribute("opacity","0"),k.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),w.after(k),await update_layers_positions_and_paths(5,"plate",20,!0,!0),m.setAttribute("opacity","1");let x=m.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"});x.onfinish=function(){y.remove(),m.remove()},k.setAttribute("opacity","1"),(x=k.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"})).onfinish=function(){q.remove(),k.remove()}}if("high_royalty"==e){let O=document.querySelectorAll("g.plate"),P=document.querySelectorAll(".layer.plate.svg"),z=Math.round(P.length/O.length),E=Math.round(Math.max(1,z)/2);for(let T of O){let D=T.querySelectorAll("svg");if(P.length<20&D.length<=z){add_or_subtract_plate_shapes_to_layer(T,E);break}}}if("low_royalty"==e){let G=document.querySelectorAll("g.plate"),I=document.querySelectorAll(".layer.plate.svg"),R=Math.round(I.length/G.length),B=Math.round(Math.max(1,R)/2);for(let Q of G){let U=Q.querySelectorAll("svg");if(U.length>0&I.length>1&U.length>=R){let Y=layers.filter(e=>e.id==Q.id.split("-")[1])[0];void 0==Y.svg_prototype&&(Y.svg_prototype=U[0]),add_or_subtract_plate_shapes_to_layer(Q,-B);break}}}if("same_royalty"==e){let F=document.querySelectorAll("g.plate");for(let H of F){let M=H.querySelectorAll("svg");if(M.length>2){let V=layers.filter(e=>e.id==H.id.split("-"[1]));void 0==V.svg_prototype&&(V.svg_prototype=M[0]),add_or_subtract_plate_shapes_to_layer(H,-1),await new Promise(e=>setTimeout(e,1e3*randomf(1,3)))}else M.length<2&&(add_or_subtract_plate_shapes_to_layer(H,1),await new Promise(e=>setTimeout(e,1e3*randomf(1,3))))}}if("approvals_increase"==e&&change_gradients_speed(t||.5),"approvals_decrease"==e&&change_gradients_speed(t||.5),"same_approvals"==e&&change_gradients_speed(0,!0),"no_approvals"==e&&change_gradients_speed(0,!0),"high_holder_distribution"==e){if(void 0==t|t<holder_distribution_upper_threshold_percent){console.log("Distribution value must be a number above holder_distribution_upper_threshold_percent");return}var W=(t-holder_distribution_upper_threshold_percent)/holder_distribution_upper_threshold_percent;for(let j of(console.log("Calculated scaling factor: "+2*W),layers))Object.values(j).includes("original_clustering_density")||(j.original_clustering_density=j.clustering_density),j.clustering_density[0]*=1+2*W,j.clustering_density[1]*=1+2*W}if("low_holder_distribution"==e){if(void 0==t|t>holder_distribution_lower_threshold_percent){console.log("Distribution value must be a number below holder_distribution_lower_threshold_percent");return}var W=(holder_distribution_lower_threshold_percent-t)/holder_distribution_lower_threshold_percent;for(let J of(console.log("Calculated scaling factor: "+2*W),layers))Object.values(J).includes("original_clustering_density")||(J.original_clustering_density=J.clustering_density),J.clustering_density[0]*=1-2*W,J.clustering_density[1]*=1-2*W}if("total_contract_activity_up"==e)for(let K of layers.filter(e=>"cluster"==e.type)){Object.values(K).includes("original_number_of_visible_shapes")||(K.original_number_of_visible_shapes=K.number_of_visible_shapes),K.number_of_visible_shapes+=number_of_cluster_shapes_to_add_or_remove_on_transfer_increase;for(let X=0;X<number_of_cluster_shapes_to_add_or_remove_on_transfer_increase;X++)add_or_subtract_cluster_shapes_to_layer(K,1)}if("total_contract_activity_down"==e)for(let Z of layers.filter(e=>"cluster"==e.type)){Object.values(Z).includes("original_number_of_visible_shapes")||(Z.original_number_of_visible_shapes=Z.number_of_visible_shapes),Z.number_of_visible_shapes-=number_of_cluster_shapes_to_add_or_remove_on_transfer_increase;for(let ee=0;ee<number_of_cluster_shapes_to_add_or_remove_on_transfer_increase;ee++)add_or_subtract_cluster_shapes_to_layer(Z,-1)}if("total_transactions_on_contract_milestone"==e){let et=special_layers.shift();layers.push(et),add_layers(layers.length-1,"top")}if("time_hodld"==e){if("3m"==t){let er=document.querySelector(".frame"),ea=er.cloneNode(!0);document.querySelector("g.group").before(ea),er.animate({opacity:"0"},{duration:5e3,iterations:1,fill:"forwards"}),setTimeout(e=>e.remove(),5e3,er)}else add_new_plate_layer()}if("piece_is_sent"==e){if(0==piece_is_sent_frame_color_changed_timestamp){change_chance_of_position_change_for_period("cluster",1,86400);let ei=document.querySelector(".frame"),en=ei.cloneNode(!0);en.classList.add("new_frame"),en.setAttribute("fill","url(#gradient_bg_mirror_read_and_black)");let eo=document.querySelector("#gradient_bg_mirror"),el=eo.cloneNode(!0);el.classList.add("gradient_bg_mirror_read_and_black"),el.setAttribute("id","gradient_bg_mirror_read_and_black");let es=Array.from(send_frame_and_background_colors);for(let e8 of el.querySelectorAll("stop")){let e$=e8.querySelector("animate");e$.setAttribute("values",es.pop()),e$.setAttribute("dur","20s")}eo.after(el),en.setAttribute("opacity","0"),en.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),ei.after(en);let ec=document.querySelector("#background"),ed=ec.cloneNode(!0);ed.setAttribute("fill","url(#gradient_bg_read_and_black)");let eu=document.querySelector("#gradient_bg"),ef=eu.cloneNode(!0);for(let ep of(ef.setAttribute("id","gradient_bg_read_and_black"),ef.querySelectorAll("stop"))){let eg=ep.querySelector("animate");eg.setAttribute("values",es.pop()),eg.setAttribute("dur","30s")}eu.after(ef),ed.setAttribute("opacity","0"),ed.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),ec.after(ed),piece_is_sent_frame_color_changed_timestamp=new Date().getTime()}await update_layers_positions_and_paths(5,"plate",100,!0,!0)}if("piece_is_sold"==e){if(0==piece_is_sold_frame_color_changed_timestamp){let e_=document.querySelector(".frame"),em=document.querySelector("#background"),eb=e_.cloneNode(!0);eb.classList.add("new_frame");let eh=em.cloneNode(!0);eh.classList.add("new_background"),eb.setAttribute("fill","url(#gradient_bg_mirror_read_and_black)"),eh.setAttribute("fill","url(#gradient_bg_read_and_black)");let ey=document.querySelector("#gradient_bg_mirror"),e3=document.querySelector("#gradient_bg"),eS=ey.cloneNode(!0);eS.classList.add("gradient_bg_mirror_read_and_black");let ev=e3.cloneNode(!0);ev.classList.add("gradient_bg_read_and_black"),eS.setAttribute("id","gradient_bg_mirror_read_and_black"),ev.setAttribute("id","gradient_bg_read_and_black");let e0=Array.from(send_frame_and_background_colors);for(let eA of eS.querySelectorAll("stop")){let e1=eA.querySelector("animate");e1.setAttribute("values",e0.pop()),e1.setAttribute("dur","20s")}for(let ew of ev.querySelectorAll("stop")){let ek=ew.querySelector("animate");ek.setAttribute("values",e0.pop()),ek.setAttribute("dur","30s")}ey.after(eS),e3.after(ev),eb.setAttribute("opacity","0"),eb.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),e_.after(eb),eh.setAttribute("opacity","0"),eh.animate([{opacity:"0",opacity:"1"}],{duration:5e3,iterations:1,fill:"forwards"}),em.after(eh)}await update_layers_positions_and_paths(5,"plate",100,!0,!0)}if("wallet_holds_2+"==e){console.log("Adding "+t-1+" plate layers");for(let e4=1;e4<t;e4++)add_new_plate_layer(["added_on_wallet_holds_multiple"],"top"),await new Promise(e=>setTimeout(e,1e3*randomi(1,5)))}if("wallet_holds_3+"==e){console.log("Adding "+(t-1)+" plate layers");for(let eN=1;eN<t;eN++)add_new_plate_layer(["added_on_wallet_holds_multiple"],"top"),await new Promise(e=>setTimeout(e,1e3*randomi(1,5)))}if("flipped_x_times"==e){let e6=document.querySelectorAll(".added_on_flip_x_times").length,eq=Math.round((t-3)/3-e6);if(e6<30){console.log("Adding "+eq+" plate layers");for(let e2=0;e2<eq;e2++)add_new_plate_layer(["added_on_flip_x_times"],"top"),await new Promise(e=>setTimeout(e,1e3*randomi(2,8)))}}if("hodld_after_flipped_x_times"==e&&remove_layer_by_class("added_on_flip_x_times"),"increased_sends"==e){let eL=pick(clustering_modes.upwards);clustering_mode=[eL,eL]}if("decreased_sends"==e){let e7=pick(clustering_modes.downwards);clustering_mode=[e7,e7]}if("same_sends"==e){let eC=pick(clustering_modes.vertical);clustering_mode=[eC,eC]}if("no_sends"==e){let ex=pick(clustering_modes.horizontal);clustering_mode=[ex,ex]}let e5=new Date().getTime();if(0!=piece_is_sent_frame_color_changed_timestamp&e5-piece_is_sent_frame_color_changed_timestamp>864e5){piece_is_sent_frame_color_changed_timestamp=0;let e9=document.querySelector(".new_frame"),eO=document.querySelector(".gradient_bg_mirror_read_and_black");e9.setAttribute("opacity","1");e9.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"}).onfinish=function(){eO.remove(),e9.remove()}}if(0!=piece_is_sold_frame_color_changed_timestamp&e5-piece_is_sold_frame_color_changed_timestamp>864e5){piece_is_sold_frame_color_changed_timestamp=0;let eP=document.querySelector(".new_frame"),ez=document.querySelector(".gradient_bg_mirror_read_and_black");eP.setAttribute("opacity","1");let eE=eP.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"});eE.onfinish=function(){ez.remove(),eP.remove()};let eT=document.querySelector(".new_background"),eD=document.querySelector(".gradient_bg_read_and_black");eT.setAttribute("opacity","1"),(eE=eT.animate([{opacity:"1",opacity:"0"}],{duration:5e3,iterations:1,fill:"forwards"})).onfinish=function(){eD.remove(),eT.remove()}}e5-startup_timestamp>864e5&plate_shapes_update_time>5&&(plate_shapes_update_time-=1)}function change_chance_of_position_change_for_period(e,t,r){for(let a of layers)a.type==e&&(void 0==a.original_change_positions_chance&&(a.original_change_positions_chance=a.change_positions_chance),a.change_positions_chance=t,setTimeout(()=>{a.change_positions_chance=a=a.original_change_positions_chance},r))}function add_or_subtract_cluster_shapes_to_layer(e,t){let r=document.querySelector(`g.${e.id}.cluster`),a=pick(r.querySelectorAll(".svg.cluster"));if(console.log(a),t<0)console.log("Removing cluster shapes",JSON.stringify(a)),a.animate({opacity:"0"},{duration:fade_time_when_new_cluster_shape_is_added_or_removed,iterations:1,fill:"forwards"}),setTimeout(e=>e.remove(),fade_time_when_new_cluster_shape_is_added_or_removed,a);else if(t>0){let i=a.cloneNode(!0),n=i.getAttribute("x").split("%")[0]*randomf(.99,1.01),o=i.getAttribute("y").split("%")[0]*randomf(.99,1.01);i.setAttribute("x",`${n}%`),i.setAttribute("y",`${o}%`),i.classList.add("animating");let l=i.animate([{opacity:"0"},{opacity:"1"}],{duration:fade_time_when_new_cluster_shape_is_added_or_removed,iterations:1,fill:"forwards"});r.appendChild(i),l.onfinish=function(){i.classList.remove("animating")}}}function add_or_subtract_plate_shapes_to_layer(e,t){if(t<0){let r=e.querySelectorAll("svg");for(let a=0;a<r.length&&!(-a<=t);a++){if(r[a].classList.contains("animating")){console.log("Shape is animating");continue}console.log("Removing shape");let i=r[a];i.classList.add("animating");i.animate([{opacity:"1"},{opacity:"0"}],{duration:fade_time_when_new_cluster_shape_is_added_or_removed,iterations:1,fill:"forwards"}).onfinish=function(){i.remove()}}}else if(t>0)for(let n=0;n<t;n++){console.log("Adding shape");let o=e.querySelector("svg");void 0==o&&(o=layers.filter(t=>t.id==e.id.split("-")[1])[0].svg_prototype);let l=o.cloneNode(!0),s=parseFloat(l.getAttribute("x").split("%")[0])+randomf(-10,10),$=parseFloat(l.getAttribute("y").split("%")[0])+randomf(-10,10);l.setAttribute("x",`${s}%`),l.setAttribute("y",`${$}%`),l.setAttribute("opacity",0),l.classList.add("animating"),l.classList.add("dynamic_add"),e.appendChild(l);l.animate({opacity:"1"},{duration:fade_time_when_new_cluster_shape_is_added_or_removed,iterations:1,fill:"forwards"}).onfinish=function(){l.classList.remove("animating")}}}function add_new_plate_layer(e=[],t="top"){let r=pick(special_layers.filter(e=>"plate"==e.type));return r.classes.push("new_layer"),r.current_path=pick(r.paths,!0),r.classes=e,layers=Array.prototype.concat(layers,[r]),add_layers(layers.length-1,t)}function remove_layer(e){let t=document.querySelector("g.plate"),r=t.animate([{opacity:1},{opacity:0}],{duration:5e3,iterations:1,fill:"forwards"});r.group=t,r.onfinish=t=>{layers=layers.filter(function(t,r){return r!=e}),r.group.remove()}}function remove_layer_by_class(e){let t=document.querySelectorAll(`g.${e}`);for(let r of t){let a=r.animate([{opacity:1},{opacity:0}],{duration:5e3,iterations:1,fill:"forwards"});a.layer=r,a.onfinish=e=>{layers=layers.filter(t=>t.id!=e.target.layer.id),a.layer.remove()}}}async function change_gradients_speed(e,t=!1){let r=document.querySelectorAll("linearGradient .animation");for(let a=0;a<r.length;a++){let i=r[a].getAttribute("dur");if(i=Number.parseInt(i.slice(0,i.length-1)),t)var n=r[a].getAttribute("original_duration");else{var n=Math.round(i*e);0==n&&(n=.1)}r[a].old_dur=i,r[a].new_dur=n,r[a].onrepeat=function(){console.log(`Changing gradient speed from ${this.old_dur}s to ${this.new_dur}s`),this.setAttribute("begin",this.getCurrentTime()),this.setAttribute("dur",`${this.new_dur}s`),this.onrepeat=void 0}}}async function update_cluster_layers_positions(e,t=!1,r=10){for(let a of layers)if("cluster"==a.type){let i=main_svg.querySelector(`.group.${a.id}`).querySelectorAll("svg");var n=generate_xy(pick(clustering_mode),2*a.number_of_visible_shapes,randomf(a.clustering_density[0],a.clustering_density[1]),.5,[3,6],a.clustering_density);for(let o=0;o<i.length;o++)if(random()>1-a.change_positions_chance&!i[o].classList.contains("animating")){i[o].classList.add("animating");var l=n[o][0],s=n[o][1];l<0&&(l+=randomi(1,10)),l>0&&(l-=randomi(1,10)),s<0&&(s+=randomi(1,10)),s>0&&(s-=randomi(1,10)),a.current_x=l,a.current_y=s,t&&(a.current_path=pick(a.paths));let $=e=>{e[0].setAttributeNS(null,"x",`${e[1]}%`),e[0].setAttributeNS(null,"y",`${e[2]}%`),e[4]&&e[0].querySelector("path").setAttributeNS(null,"d",e[3])};0==r?fade_and_execute_func([i[o]],e,$,[i[o],l,s,a.current_path,t]):setTimeout(fade_and_execute_func,1e3*randomi(0,r),[i[o]],e,$,[i[o],l,s,a.current_path,t])}}for(;stop_all_animations;)console.log("animations are stopped"),await new Promise(e=>setTimeout(e,1e3));setTimeout(update_cluster_layers_positions,1e3*cluster_shapes_update_time,e,t,r)}async function update_plate_layers_positions(e,t=!1,r=10){let a=!1;for(let i of layers){if("plate"==i.type){let n=main_svg.querySelector(`.group.${i.id}`).querySelectorAll("svg");for(let o=0;o<n.length;o++){if(random()>1-i.change_positions_chance&!n[o].classList.contains("animating")){n[o].classList.add("animating"),10>Math.abs(i.current_x-l)&&(l=i.current_x+randomf(-20,20)),10>Math.abs(i.current_y-s)&&(s=i.current_y+randomf(-20,20));var l=randomf(i.coordinates[0][0],i.coordinates[0][1])/i.current_scale,s=randomf(i.coordinates[1][0],i.coordinates[1][1])/i.current_scale;i.current_x=l,i.current_y=s,t&&(i.current_path=pick(i.paths));let $=e=>{e[0].setAttributeNS(null,"x",`${e[1]}%`),e[0].setAttributeNS(null,"y",`${e[2]}%`),e[4]&&e[0].querySelector("path").setAttributeNS(null,"d",e[3])};0==r?fade_and_execute_func([n[o]],e,$,[n[o],l,s,i.current_path,t]):setTimeout(fade_and_execute_func,1e3*randomi(0,r),[n[o]],e,$,[n[o],l,s,i.current_path,t]),a=!0;break}if(a)break}if(a)break}if(a)break}for(;stop_all_animations;)console.log("animations are stopped"),await new Promise(e=>setTimeout(e,1e3));setTimeout(update_plate_layers_positions,1e3*plate_shapes_update_time,e,t,r)}function change_color_mode(e){color_mode=e}async function update_layers_order(e=.5,t=5,r=2,a=!1){console.log("Changing order");let i=document.querySelectorAll(".group.layer"),n=document.querySelector("#main-svg"),o=0;for(let l=2;l<i.length&&!(o>=r);l+=2)if(random()>1-e){let s=e=>{e[0].insertBefore(e[2],e[3]),e[0].insertBefore(e[1],e[2])};fade_and_execute_func([i[l],i[l+1]],t,s,[n,i[l],i[l+1],i[0]]),o+=1,a&&await new Promise(e=>setTimeout(e,1e3*randomf(3,6)))}setTimeout(function(){let e=[],t=document.querySelectorAll(".group.layer");for(let r=0;r<t.length;r++)for(let a=0;a<layers.length;a++)if(t[r].getAttribute("class").includes(layers[a].id)){e.push(layers[a]);break}layers=e},2e3*t)}async function update_layers_positions_and_paths(e=5,t="both",r=4,a=!1,i=!1){console.log("Changing positions and paths");for(let n=0;n<layers.length;n++){let o=layers[n];if("both"!=t&t!=o.type)continue;let l=main_svg.querySelector(`.group.${o.id}`);if(void 0==l){o.delete=!0;continue}let s=l.querySelectorAll("svg");if("cluster"==o.type){var $=generate_xy(pick(clustering_mode),o.number_of_visible_shapes,randomf(o.clustering_density[0],o.clustering_density[1]),.5,[3,6],o.clustering_density);shuffle($)}let c=0;for(let d=0;d<s.length&&!(c>=r);d++){let u=!!a||random()>1-o.change_positions_chance;if(!s[d].classList.contains("animating")&u){if(s[d].classList.add("animating"),"cluster"==o.type){var f=$[d][0],p=$[d][1];10>Math.abs(o.current_x-f)&&(f=o.current_x+randomf(10,20)),10>Math.abs(o.current_y-p)&&(p=o.current_y+randomf(10,20))}else{var f=randomf(o.coordinates[0][0],o.coordinates[0][1])/o.current_scale,p=randomf(o.coordinates[1][0],o.coordinates[1][1])/o.current_scale;10>Math.abs(o.current_x-f)&&(f=o.current_x+randomf(10,20)),10>Math.abs(o.current_y-p)&&(p=o.current_y+randomf(10,20))}for(o.current_x=f,o.current_y=p;;)if(pick(o.paths)!=o.current_path){o.current_path=pick(o.paths);break}let g=e=>{e[0].setAttributeNS(null,"x",`${e[1]}%`),e[0].setAttributeNS(null,"y",`${e[2]}%`),e[0].querySelector("path").setAttributeNS(null,"d",e[3])};fade_and_execute_func([s[d]],e,g,[s[d],f,p,o.current_path]),i&&await new Promise(e=>setTimeout(e,1e3*randomi(2,8))),c++}}}layers=layers.filter(e=>!0!=e.delete)}function update_layers_gradients(e=5){main_svg=document.querySelector("#main-svg");for(let t=0;t<layers.length;t++){let r;fade_and_execute_func([main_svg.querySelector(`.group.${layers[t].id}`)],e,e=>{let t=e[0],r=document.querySelector(`.gradient.${t.id}`).querySelectorAll(".animation");pick_color_from_colors_list(t.color_combinations_list),r[0].setAttributeNS(null,"values",new_colors[0]),r[1].setAttributeNS(null,"values",new_colors[1])},[layers[t]])}}function update_background_and_frame_gradients(e=5){let t=document.querySelector("#main-svg"),r=t.querySelector("#defs"),a=r.querySelector("#gradient_bg"),i=r.querySelector("#gradient_bg_mirror"),n=a.cloneNode(!0),o=i.cloneNode(!0);n.setAttribute("id","gradient_bg_copy"),o.setAttribute("id","gradient_bg_mirror_copy");let l=pick_color_from_colors_list(background_color_combinations_list);a.after(n,o);let s=t.querySelector("#background"),$=s.cloneNode(!0);$.setAttribute("fill","url(#gradient_bg_copy)"),s.before($);let c=t.querySelector(".frame"),d=c.cloneNode(!0);d.setAttribute("fill","url(#gradient_bg_mirror_copy)"),c.before(d);let u=([e,t,r])=>{let a=e.querySelectorAll(".animation");r?(a[1].setAttributeNS(null,"values",t[1]),a[0].setAttributeNS(null,"values",t[0])):(a[0].setAttributeNS(null,"values",t[1]),a[1].setAttributeNS(null,"values",t[0]))};fade_and_execute_func([s],e,u,[a,l,!1]),setTimeout(function(){$.remove(),n.remove()},2e3*e),fade_and_execute_func([c],e,u,[i,l,!0]),setTimeout(function(){d.remove(),o.remove()},2e3*e)}function update_background_and_frame_gradient_speed(e,t=5,r=!1){let a=document.querySelector("#main-svg"),i=a.querySelector("#defs"),n=i.querySelector("#gradient_bg"),o=i.querySelector("#gradient_bg_mirror"),l=n.cloneNode(!0),s=o.cloneNode(!0);l.setAttribute("id","gradient_bg_copy"),s.setAttribute("id","gradient_bg_mirror_copy"),n.after(l,s);let $=a.querySelector("#background"),c=$.cloneNode(!0);c.setAttribute("fill","url(#gradient_bg_copy)"),$.before(c);let d=a.querySelector(".frame"),u=d.cloneNode(!0);u.setAttribute("fill","url(#gradient_bg_mirror_copy)"),d.before(u);let f=([t])=>{let a=t.querySelectorAll(".animation");for(let i=0;i<a.length;i++){if(r)var n=a[i].getAttribute("original_duration");else{var o=a[i].getAttribute("dur"),n=Math.round((o=Number.parseInt(o.slice(0,o.length-1)))*e);0==n&&(n=.1)}a[i].setAttribute("dur",`${n}s`)}};fade_and_execute_func([$],t,f,[n]),setTimeout(function(){c.remove(),l.remove()},2e3*t),fade_and_execute_func([d],t,f,[o]),setTimeout(function(){u.remove(),s.remove()},2e3*t)}async function fade_and_execute_func(e,t,r,a,i=0){e=e.filter(e=>void 0!=e),0!=i&&await new Promise(e=>setTimeout(e,i));let n={duration:1e3*t,iterations:1,fill:"forwards"};for(let o=0;o<e.length;o++)e[o].animate({opacity:"0"},n);setTimeout(function t(){r(a);for(let i=0;i<e.length;i++)e[i].animate({opacity:"1"},n),e[i].classList.remove("animating")},1e3*t)}function add_layers(e=-1,t="bottom"){let r=document.querySelector("#main-svg"),a=r.querySelector("#defs");for(let i=0;i<layers.length;i++){if(-1!=e&i!=e)continue;let n=layers[i];if("cluster"==n.type){let o=layers[i-1];random(),o.current_x,o.current_scale,randomf(n.coordinates[0][0],n.coordinates[0][1]),o.current_y,o.current_scale,randomf(n.coordinates[1][0],n.coordinates[1][1])}let l=pick_color_from_colors_list(n.color_combinations_list),s=`g-${n.id}-${n.type}`,$=randomf(n.color_duration[0],n.color_duration[1]);n.current_scale=randomf(n.scale[0],n.scale[1],.01);let c=makeGradient(n.gradient_coordinates,s);c.setAttributeNS(null,"class",`gradient ${n.type} ${n.id}`);let d=makeStop(0,l[0]),u=makeStop(1,l[1]),f=makeStopAnimation(l[0],$),p=makeStopAnimation(l[1],$);f.setAttribute("original_duration",$),p.setAttribute("original_duration",$),d.appendChild(f),u.appendChild(p),c.appendChild(d),c.appendChild(u),a.appendChild(c);let g=document.createElementNS(svgns,"g");if(g.setAttributeNS(null,"id",`g-${n.id}-${n.type}-${i}`),g.setAttributeNS(null,"class",`layer group ${n.type} ${n.id}`),"cluster"==n.type)var _=generate_xy(pick(clustering_mode),n.number_of_visible_shapes,randomf(n.clustering_density[0],n.clustering_density[1]),.5,[3,6],n.clustering_density);for(let m=0;m<n.number_of_visible_shapes;m++){let h=`p-${n.id}-${n.type}-${m}`,y=`s-${n.id}-${n.type}-${m}`,S=1;if("plate"==n.type){var v=randomi(n.coordinates[0][0],n.coordinates[0][1])/n.current_scale,A=randomi(n.coordinates[1][0],n.coordinates[1][1])/n.current_scale;n.current_x=v,n.current_y=A,n.current_path=pick(n.paths,use_token_id_seed_for_initial_layer_paths)}else{var v=_[m][0],A=_[m][1];n.current_x=v,n.current_y=A,n.current_path=pick(n.paths,use_token_id_seed_for_initial_layer_paths),randomize_cluster_shapes_scale.length&&(S=randomf(randomize_cluster_shapes_scale[0],randomize_cluster_shapes_scale[1],.01))}let w=document.createElementNS(svgns,"path");w.setAttributeNS(null,"transform",`scale(${n.current_scale*S}, ${n.current_scale*S})`),w.setAttributeNS(null,"d",n.current_path),w.setAttributeNS(null,"fill",`url(#${s})`),w.setAttributeNS(null,"id",h),w.setAttributeNS(null,"class",`layer path ${n.type} ${n.id}`);let k=document.createElementNS(svgns,"svg");for(let N of(k.setAttributeNS(null,"x",`${v}%`),k.setAttributeNS(null,"y",`${A}%`),k.setAttributeNS(null,"transform-origin","center"),k.setAttributeNS(null,"id",y),k.setAttributeNS(null,"class",`layer svg ${n.type} ${n.id}`),n.classes))k.classList.add(N),g.classList.add(N);k.appendChild(w),g.appendChild(k)}if(-1==e)r.appendChild(g);else{if(g.animate([{opacity:"0"},{opacity:"1"}],{duration:fade_in_speed_when_new_layers_are_added,iterations:1,fill:"forwards"}),"top"==t){let q=document.querySelectorAll(".group.plate");q[q.length-1].after(g)}else document.querySelector(".group.plate").before(g);return g}}}function add_defs_svg(){let e=document.querySelector("#main-svg"),t=document.createElementNS(svgns,"defs");t.setAttributeNS(null,"id","defs"),e.appendChild(t)}function add_background(){let e=document.querySelector("#main-svg"),t=pick(background_color_durations),r=pick_color_from_colors_list(background_color_combinations_list),a=e.querySelector("#defs"),i=makeGradient([0,0,100,0],"gradient_bg"),n=makeStop(0,"#000000"),o=makeStop(1,"#000000"),l=makeStopAnimation(r[0],t),s=makeStopAnimation(r[1],t);n.appendChild(l),o.appendChild(s),i.appendChild(n),i.appendChild(o),a.appendChild(i),i=makeGradient([0,0,100,0],"gradient_bg_mirror"),n=makeStop(0,"#000000"),o=makeStop(1,"#000000"),l=makeStopAnimation(r[1],t),s=makeStopAnimation(r[0],t),l.setAttribute("original_duration",t),s.setAttribute("original_duration",t),n.appendChild(l),o.appendChild(s),i.appendChild(n),i.appendChild(o),a.appendChild(i);let $=document.createElementNS(svgns,"svg");$.setAttributeNS(null,"width","100%"),$.setAttributeNS(null,"height","100%"),$.setAttributeNS(null,"x",0),$.setAttributeNS(null,"y",0);let c=document.createElementNS(svgns,"rect");c.setAttributeNS(null,"width","100%"),c.setAttributeNS(null,"height","100%"),c.setAttributeNS(null,"x",0),c.setAttributeNS(null,"y",0),c.setAttributeNS(null,"fill","url(#gradient_bg)"),c.setAttributeNS(null,"id","background"),$.appendChild(c),e.appendChild($)}function add_background_border(){let e=document.querySelector("#main-svg"),t=e.querySelector("#defs"),r=document.createElementNS(svgns,"mask");r.setAttributeNS(null,"id","bg_border_clip_path");let a=document.createElementNS(svgns,"rect");a.setAttributeNS(null,"width","101%"),a.setAttributeNS(null,"height","101%"),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"fill","white");let i=document.createElementNS(svgns,"rect");i.setAttributeNS(null,"width","94%"),i.setAttributeNS(null,"height","95.3%"),i.setAttributeNS(null,"x","3%"),i.setAttributeNS(null,"y","2.5%"),i.setAttributeNS(null,"fill","black"),r.appendChild(a),r.appendChild(i),t.appendChild(r);let n=document.createElementNS(svgns,"rect");n.setAttributeNS(null,"width","100%"),n.setAttributeNS(null,"height","100%"),n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"fill","url(#gradient_bg_mirror)"),n.setAttributeNS(null,"mask","url(#bg_border_clip_path)"),n.setAttributeNS(null,"class","frame"),e.appendChild(n)}function makeStop(e,t){let r=document.createElementNS(svgns,"stop");return r.setAttributeNS(null,"offset",e),r.setAttributeNS(null,"stop-color",t),r}function makeStopAnimation(e,t){let r=document.createElementNS(svgns,"animate");return r.setAttributeNS(null,"attributeName","stop-color"),r.setAttributeNS(null,"values",e),r.setAttributeNS(null,"dur",t+"s"),r.setAttributeNS(null,"repeatCount","indefinite"),r.setAttributeNS(null,"class","animation"),r}function makeGradient(e,t){var r=document.createElementNS(svgns,"linearGradient");return r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"x1",e[0]+"%"),r.setAttributeNS(null,"x2",e[2]+"%"),r.setAttributeNS(null,"y1",e[1]+"%"),r.setAttributeNS(null,"y2",e[3]+"%"),r}function random(){var e=1e4*Math.sin(seedi++);return e-Math.floor(e)}function random_token(){var e=1e4*Math.sin(seed_token++);return e-Math.floor(e)}function randomi(e,t,r=!0){return e=Math.ceil(e),t=Math.floor(t),r?Math.floor(random()*(t+1-e)+e):Math.floor(random_token()*(t+1-e)+e)}function randomf(e,t,r=1,a=3,i=!0){return round_down(i?random()*(t+r-e)+e:random_token()*(t+r-e)+e,a)}function pick(e,t=!0){return e[randomi(0,e.length-1,t)]}function uid(){return""+random().toString(16).slice(2)}function round_down(e,t){return Math.floor(e*Math.pow(10,t=t||0))/Math.pow(10,t)}function shuffle(e){let t=e.length,r;for(;0!=t;)r=Math.floor(random()*t),t--,[e[t],e[r]]=[e[r],e[t]];return e}function generate_xy(e,t,r=0,a=0,i=[3,8],n=[1,3],o=0,l=[-200,300]){var s,$,c,d,u,f,p,g,_,m,h,y;if(0==e&&($=generatePointsOnLineCluster(45,95,40,10,r+10,t+1),c=generatePointsOnLineCluster(30,55,40,20,r+20,t+1),d=generatePointsOnLineCluster(40,0,40,30,r+30,t+1)),1==e&&($=generatePointsOnLineCluster(60,0,90,30,r+40,t+1),c=generatePointsOnLineCluster(20,40,20,40,r+20,t+1),d=generatePointsOnLineCluster(40,70,100,50,r+30,t+1)),5==e&&(d=generatePointsOnLineCluster(10,5,0,10,r+40,t+1),$=generatePointsOnLineCluster(20,10,1,50,r+50,t+1),c=generatePointsOnLineCluster(30,30,0,20,r+60,t+1)),3==e&&(d=generatePointsOnLineCluster(90,0,160,0,r+20,t+1),c=generatePointsOnLineCluster(50,50,160,0,r+30,t+1),$=generatePointsOnLineCluster(10,70,160,0,r+40,t+1)),6==e&&($=generatePointsOnLineCluster(50,50,10,10,r+30,t+1),c=generatePointsOnLineCluster(50,20,20,10,r+5,t+1),d=generatePointsOnLineCluster(50,50,30,10,r+10,t+1)),2==e&&($=generatePointsOnLineCluster(0,10,20,10,r+5,t+1),c=generatePointsOnLineCluster(80,40,10,20,r+10,t+1),d=generatePointsOnLineCluster(90,30,40,30,r+30,t+1)),4==e){for(g=0,s=[],p=t/100;g<t;g++)u=b=g/p,f=g|b&u,u+=randomf(-f%10,f%10)+Math.sin(b)*f%30,f+=randomf(-g%10,g%10),s.push({x:u%110,y:f%110});$=s,c=s,d=s}if(7==e&&($=generatePointsOnLineCluster(95,30,-40,13,r+10,2*t),c=generatePointsOnLineCluster(90,40,-35,20,r+20,t+1),d=generatePointsOnLineCluster(80,50,-30,30,r+30,t+1)),8==e&&($=generatePointsOnLineCluster(60,50,-10,10,r+10,t+1),c=generatePointsOnLineCluster(70,50,10,20,r+20,t+1),d=generatePointsOnLineCluster(80,50,20,30,r+30,t+1)),9==e){for(g=0,s=[],p=t/100;g<t;g++)u=g%100,f=((f=(u=randomi(10,70)+g%100)|g>>p)&u|g)%100,random()>.4&&(f=randomi(20,50)-Math.sin(g)),random()>.6&&(u*=Math.sin(f)),u+=randomf(-15,15)%100,f+=randomf(-15,15)%100,s.push({x:u,y:f});$=s,c=s,d=s}for(10==e&&($=generatePointsOnLineCluster(3,10,-5,20,r+10,t+1),c=generatePointsOnLineCluster(10,80,-10,20,r+20,t+1),d=generatePointsOnLineCluster(80,20,-20,10,r+30,t+1)),11==e&&($=generatePointsOnLineCluster(15,10,-5,30,r+40,t+1),c=generatePointsOnLineCluster(50,80,-10,26,r+30,t+1),d=generatePointsOnLineCluster(80,40,-10,15,r+20,t+1)),_=[],s=[$,c,d],g=0;g<t;g++)_.push(pick(s)[g]);if(a>0)for(g=0,m=!1,h=0,y=0;g<_.length;g++)m?(g<y&&(_[g].x=_[h].x+randomf(-p,p),_[g].y=_[h].y+randomf(-p,p)),g>y&&(m=!1)):random()>a&&(m=!0,h=g,y=g+randomi(i),p=randomf(n[0],n[1]));let S=[];for(g=0;g<_.length;g++)_[g].x<l[0]|_[g].x>l[1]&&(_[g].x=randomf(0,100,3)),_[g].y<l[0]|_[g].y>l[1]&&(_[g].y=randomf(0,100,3)),o>0&&random()>1-o&&(_[g].x=randomf(0,100,3),_[g].y=randomf(0,100,3)),S.push([_[g].x,_[g].y]);return S}function generatePointsOnLineCluster(e,t,r,a,i,n){let o=Math.tan(r),l=Math.cos(r)*a,s=Math.sin(r)*a,$=[];for(let c=0;c<n;c++){let d=(random()-.5)*i,u=(random()-.5)*i,f=e+l+d,p=t+o*(f-e)+s+u;$.push({x:f,y:p})}return $}function select_global_color_combination(){let e=random();for(let t=0;t<color_combinations.length;t++){if(e>1-color_combinations[t].chance)return console.log("Selected color combination: ",t),color_combinations[t].colors;e=random()}return console.log("Selected default color combination 0 "),color_combinations[0].colors}function pick_color_from_colors_list(e){for(let t of e)if(random()>1-t.chance)return shuffle(t.colors.regular[0]);return shuffle(e[0].colors.regular[0])}function trend(e,t){let r=0,a=1/t,i=0;if(e.length>1){if(e[e.length-1]>e[e.length-2])return 1;if(e[e.length-1]<e[e.length-2])return -1}for(let n=e.length-t+1;n<e.length;n++)r+=a,i+=(e[n]-e[n-1])*r;return i>.1?1:i<-.1?-1:0}async function open_screenshot_in_another_tab(){let e=document.querySelector("#main-svg"),t=document.createElement("canvas");t.width=1e4,t.height=1e4;let r=new XMLSerializer().serializeToString(e),a=new Image;a.src="data:image/svg+xml;base64,"+btoa(r),a.onload=function(){let e=t.getContext("2d");e.drawImage(a,0,0);let r=t.toDataURL("image/png");var i=window.open();let n=new Image;n.src=r,i.document.body.appendChild(n)}}setTimeout(update_cluster_layers_positions,5e3,cluster_shapes_fade_time,!0,cluster_shapes_fade_trigger_randomize),setTimeout(update_plate_layers_positions,5e3,plate_shapes_fade_time,!0,plate_shapes_fade_trigger_randomize);